# MiniPdf Self-Evolution Benchmark

è‡ªåŠ¨åŒ–æ¯”å¯¹ MiniPdf ä¸ LibreOffice(å‚è€ƒå®ç°) ç”Ÿæˆ PDF çš„å·®å¼‚ï¼ŒæŒç»­æ”¹è¿›æ¸²æŸ“å“è´¨ã€‚

## æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  run_benchmark.py (æ€»æ§)                     â”‚
â”‚                  Run-Benchmark.ps1 (ä¸€é”®å…¥å£)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Step 1: generate_classic_xlsx.py                           â”‚
â”‚          ç”¨ openpyxl ç”Ÿæˆ 30 ç§ç»å…¸ Excel æµ‹è¯•æ–‡ä»¶           â”‚
â”‚          â†’ tests/MiniPdf.Scripts/output/*.xlsx               â”‚
â”‚                                                             â”‚
â”‚  Step 2: convert_xlsx_to_pdf.cs                             â”‚
â”‚          ç”¨ MiniPdf å°† xlsx è½¬ä¸º PDF                        â”‚
â”‚          â†’ tests/MiniPdf.Scripts/pdf_output/*.pdf            â”‚
â”‚                                                             â”‚
â”‚  Step 3: generate_reference_pdfs.py                         â”‚
â”‚          ç”¨ LibreOffice å°† xlsx è½¬ä¸º PDFï¼ˆå‚è€ƒæ ‡å‡†ï¼‰         â”‚
â”‚          â†’ tests/MiniPdf.Benchmark/reference_pdfs/*.pdf      â”‚
â”‚                                                             â”‚
â”‚  Step 4: compare_pdfs.py                                    â”‚
â”‚          å¯¹æ¯”ä¸¤ç»„ PDF çš„æ–‡æœ¬å†…å®¹ + è§†è§‰åƒç´ å·®å¼‚              â”‚
â”‚          â†’ tests/MiniPdf.Benchmark/reports/                  â”‚
â”‚            â”œâ”€â”€ comparison_report.md   (äººç±»å¯è¯»æŠ¥å‘Š)         â”‚
â”‚            â”œâ”€â”€ comparison_report.json (æœºå™¨å¯è¯»æ•°æ®)         â”‚
â”‚            â””â”€â”€ images/                (é€é¡µæ¸²æŸ“å¯¹æ¯”å›¾)       â”‚
â”‚                                                             â”‚
â”‚  Step 5: åˆ†ææŠ¥å‘Šï¼Œæ‰¾å‡ºå¾—åˆ†æœ€ä½çš„æµ‹è¯•æ¡ˆä¾‹è¿›è¡Œæ”¹è¿›            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

```bash
# 1. Python 3.10+ & ä¾èµ–
pip install openpyxl pymupdf

# 2. LibreOffice (å…è´¹ï¼Œç”¨äºç”Ÿæˆå‚è€ƒ PDF)
#    Windows: https://www.libreoffice.org/download/
#    æˆ– winget install LibreOffice

# 3. .NET 9 SDK
```

### ä¸€é”®æ‰§è¡Œ

```powershell
# Windows PowerShell
.\Run-Benchmark.ps1

# æˆ–ç›´æ¥ç”¨ Python
cd tests/MiniPdf.Benchmark
python run_benchmark.py
```

### åˆ†æ­¥æ‰§è¡Œ

```powershell
# 1. ç”Ÿæˆ Excel æµ‹è¯•æ–‡ä»¶
cd tests/MiniPdf.Scripts
python generate_classic_xlsx.py

# 2. MiniPdf è½¬ PDF
dotnet run convert_xlsx_to_pdf.cs

# 3. LibreOffice å‚è€ƒè½¬æ¢
cd ../MiniPdf.Benchmark
python generate_reference_pdfs.py

# 4. å¯¹æ¯”åˆ†æ
python compare_pdfs.py

# 5. åªè·‘å¯¹æ¯”ï¼ˆè·³è¿‡ç”Ÿæˆæ­¥éª¤ï¼‰
python run_benchmark.py --compare-only
```

## æ¯”å¯¹è¯„åˆ†æœºåˆ¶

æ¯ä¸ªæµ‹è¯•æ¡ˆä¾‹å¾—åˆ° 0.0 ~ 1.0 çš„ç»¼åˆè¯„åˆ†ï¼š

| ç»´åº¦     | æƒé‡ | è¯´æ˜                                    |
|----------|------|-----------------------------------------|
| æ–‡æœ¬ç›¸ä¼¼åº¦ | 40%  | æå–ä¸¤ä»½ PDF æ–‡æœ¬å†…å®¹åš SequenceMatcher æ¯”å¯¹ |
| è§†è§‰ç›¸ä¼¼åº¦ | 40%  | é€é¡µæ¸²æŸ“æˆåƒç´ æ¯”å¯¹åŒ¹é…ç‡                  |
| é¡µæ•°åŒ¹é…  | 20%  | é¡µæ•°ç›¸åŒå¾— 1.0ï¼Œä¸åŒå¾— 0.5              |

è¯„åˆ†ç­‰çº§ï¼š
- ğŸŸ¢ â‰¥ 0.9 â€” ä¼˜ç§€
- ğŸŸ¡ 0.7 ~ 0.9 â€” è‰¯å¥½ï¼Œæœ‰æ”¹è¿›ç©ºé—´
- ğŸ”´ < 0.7 â€” å·®å¼‚è¾ƒå¤§ï¼Œéœ€é‡ç‚¹å…³æ³¨

## ã€Œè‡ªè¿›åŒ–ã€è¿­ä»£æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¿è¡Œ Benchmark Pipeline    â”‚
â”‚     â†’ ç”Ÿæˆæ¯”å¯¹æŠ¥å‘Š             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. åˆ†æä½åˆ†æµ‹è¯•æ¡ˆä¾‹           â”‚
â”‚     â†’ æ‰¾å‡ºå…·ä½“å·®å¼‚ï¼ˆæ–‡æœ¬/è§†è§‰ï¼‰ â”‚
â”‚     â†’ æŸ¥çœ‹ diff å’Œæ¸²æŸ“å¯¹æ¯”å›¾   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ä¿®æ”¹ ExcelToPdfConverter   â”‚
â”‚     â†’ æ”¹è¿›æ¸²æŸ“é€»è¾‘             â”‚
â”‚     â†’ ä¿®å¤ Bug                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. é‡æ–°è¿è¡Œ Benchmark         â”‚
â”‚     â†’ éªŒè¯åˆ†æ•°æ˜¯å¦æå‡          â”‚
â”‚     â†’ ç¡®ä¿æ²¡æœ‰å›é€€              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
       å›åˆ° Step 1
       ï¼ˆæŒç»­è¿­ä»£ï¼‰
```

### è®© AI è‡ªåŠ¨è¿›åŒ–çš„å·¥ä½œæµ

å½“ä½ ä½¿ç”¨ AI åŠ©æ‰‹ï¼ˆå¦‚ GitHub Copilotï¼‰æ—¶ï¼Œå¯ä»¥è¿™æ ·æ“ä½œï¼š

1. **è¿è¡Œ Benchmark**ï¼š
   ```
   .\Run-Benchmark.ps1
   ```

2. **æŠŠæŠ¥å‘Šç»™ AI çœ‹**ï¼š
   ```
   è¯·æŸ¥çœ‹ tests/MiniPdf.Benchmark/reports/comparison_report.md
   æ‰¾å‡ºå¾—åˆ†æœ€ä½çš„æµ‹è¯•æ¡ˆä¾‹ï¼Œåˆ†æå·®å¼‚åŸå› ï¼Œå¹¶è‡ªåŠ¨ä¿®æ”¹ ExcelToPdfConverter.cs æ¥æ”¹è¿›ã€‚
   ```

3. **AI ä¿®æ”¹ä»£ç åé‡æ–°éªŒè¯**ï¼š
   ```
   .\Run-Benchmark.ps1 --SkipGenerate --SkipReference
   ```

4. **å¾ªç¯è¿­ä»£ç›´åˆ°æ‰€æœ‰åˆ†æ•° â‰¥ 0.9**ã€‚

## æ‰©å±•æµ‹è¯•

åœ¨ `generate_classic_xlsx.py` ä¸­æ–°å¢æµ‹è¯•ç”¨ä¾‹ï¼š

```python
def classic31_your_new_case():
    wb = Workbook()
    ws = wb.active
    # ... ä½ çš„æ–°åœºæ™¯ ...
    save(wb, "classic31_your_new_case.xlsx")
```

ç„¶ååœ¨ `main()` çš„ `generators` åˆ—è¡¨ä¸­åŠ å…¥ `classic31_your_new_case`ï¼Œé‡æ–°è¿è¡Œ pipeline å³å¯ã€‚

## æ–‡ä»¶ç»“æ„

```
tests/
â”œâ”€â”€ MiniPdf.Scripts/
â”‚   â”œâ”€â”€ generate_classic_xlsx.py    # ç”Ÿæˆ 30 ç§æµ‹è¯• Excel
â”‚   â”œâ”€â”€ convert_xlsx_to_pdf.cs      # MiniPdf è½¬ PDF è„šæœ¬
â”‚   â”œâ”€â”€ output/                     # ç”Ÿæˆçš„ .xlsx æ–‡ä»¶
â”‚   â””â”€â”€ pdf_output/                 # MiniPdf ç”Ÿæˆçš„ .pdf
â”‚
â”œâ”€â”€ MiniPdf.Benchmark/
â”‚   â”œâ”€â”€ run_benchmark.py            # æ€»æ§è„šæœ¬
â”‚   â”œâ”€â”€ generate_reference_pdfs.py  # LibreOffice å‚è€ƒè½¬æ¢
â”‚   â”œâ”€â”€ compare_pdfs.py             # PDF æ¯”å¯¹å¼•æ“
â”‚   â”œâ”€â”€ reference_pdfs/             # LibreOffice ç”Ÿæˆçš„å‚è€ƒ .pdf
â”‚   â”œâ”€â”€ reports/                    # æ¯”å¯¹æŠ¥å‘Šè¾“å‡º
â”‚   â”‚   â”œâ”€â”€ comparison_report.md
â”‚   â”‚   â”œâ”€â”€ comparison_report.json
â”‚   â”‚   â””â”€â”€ images/                 # é€é¡µæ¸²æŸ“å¯¹æ¯”å›¾
â”‚   â””â”€â”€ README.md                   # æœ¬æ–‡æ¡£
â”‚
Run-Benchmark.ps1                   # Windows ä¸€é”®æ‰§è¡Œå…¥å£
```
